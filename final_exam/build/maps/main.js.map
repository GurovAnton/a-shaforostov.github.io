{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["// Код, который запускается при загрузке скрипта\r\nwindow.onload = documentReady;\r\n// Код, который запускается при загрузке скрипта\r\n// ---------------------------------------------\r\n\r\n\r\n// Получение картинок с сервиса \r\n\r\n// Запросить картинки по запросу\r\nfunction getPictures (request) {\r\n\tvar docHead = document.getElementsByTagName('head')[0]; // For IE8-\r\n\tvar q = request ? '&q='+encodeURIComponent(request) : '';\r\n\tvar elem = document.getElementById('pixabayRequest');\r\n\tif (elem) { docHead.removeChild(elem); }\r\n\telem = document.createElement(\"script\");\r\n\telem.id = 'pixabayRequest';\r\n\telem.src = \"https://pixabay.com/api/?key=2654122-2e7cfe65e4216a71a55f9c97a&image_type=photo\"+q+\"&callback=onData\";\r\n\tdocHead.appendChild(elem);\r\n}\r\n\r\n// Обработчик на получение данных JSONP\r\nfunction onData(data) {\r\n\tif (data) {\r\n\r\n\t\t// Заполнить картинками\r\n\t\tvar grid = document.querySelector('.grid');\r\n\t\tfor (var i = 0; i < 7; i++) {\r\n\t\t\tvar img = grid.querySelector('.grid__item--'+(i+1)+' .grid__item-img');\r\n\t\t\tif (data.hits[i]) {\r\n\t\t\t\timg.src = data.hits[i].webformatURL;\r\n\t\t\t\timg.parentNode.querySelector('.grid__caption').innerHTML = data.hits[i].tags;\r\n\t\t\t\timg.setAttribute('data-width', data.hits[i].webformatWidth);\r\n\t\t\t\timg.setAttribute('data-height', data.hits[i].webformatHeight);\r\n\t\t\t} else {\r\n\t\t\t\timg.src = '';\r\n\t\t\t\timg.parentNode.querySelector('.grid__caption').innerHTML = 'Empty';\r\n\t\t\t\timg.setAttribute('data-width', 0);\r\n\t\t\t\timg.setAttribute('data-height', 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Масштабировать картинки\r\n\t\tvar gridItems = grid.querySelectorAll('grid__item');\r\n\t\tfor (var i = 0; i < gridItems.length; i++) {\r\n\t\t\tvar el = gridItems[i];\r\n\t\t\tvar refH = el.offsetHeight;\r\n\t\t\tvar refW = el.offsetWidth;\r\n\r\n\t\t\tvar imgH = el.getElementsByTagName(\"img\")[0].getAttribute('data-height');\r\n\t\t\tvar imgW = el.getElementsByTagName(\"img\")[0].getAttribute('data-width');\r\n\t\t\t\r\n\t\t\tif (imgH-refH > imgW-refW) {\r\n\t\t\t\tel.classList.add(\"grid__item--portrait\");\r\n\t\t\t\tel.classList.remove(\"grid__item--landscape\");\r\n\t\t\t} else {\r\n\t\t\t\tel.classList.add(\"grid__item--landscape\");\r\n\t\t\t\tel.classList.remove(\"grid__item--portrait\");\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n// Получение картинок с сервиса \r\n\r\n\r\n//Класс слайдера\r\nfunction Slider(element, frame) {\r\n\tthis.frame = frame;\r\n\tthis.imgs = element.querySelectorAll('.slider__scr');\r\n\t\r\n\tthis.set(this.frame, 'block');\r\n};\t\r\n\r\nSlider.prototype.set = function(frame, value) { // установка нужного фона слайдеру\r\n\tthis.imgs[frame].style.display = value;\r\n};\r\n\r\nSlider.prototype.left = function() { // крутим на один кадр влево\r\n\tthis.set(this.frame, 'none');\r\n\tthis.frame--;\r\n\tif(this.frame < 0) this.frame = this.imgs.length-1;\r\n\tthis.set(this.frame, 'block');\r\n};\r\n\r\nSlider.prototype.right = function() { // крутим на один кадр вправо\r\n\tthis.set(this.frame, 'none');\r\n\tthis.frame++;\r\n\tif(this.frame === this.imgs.length) this.frame = 0;\r\n\tthis.set(this.frame, 'block');\r\n};\r\n//Класс слайдера\r\n\r\n\r\n// Функция запускается после загрузки документа\r\nfunction documentReady() {\r\n\r\n\t// Инициализация Masonry\r\n\tvar msnry = new Masonry('.grid', {\r\n\t\titemSelector: '.grid__item',\r\n\t\tcolumnWidth: '.grid__sizer',\r\n\t\tgutter: 1\r\n\t});\r\n\r\n\t// Инициализация слайдеров\r\n\tvar sliders = document.querySelectorAll('.slider');\r\n\twindow.mySliders = [];\r\n\tfor (var sl = 0; sl < sliders.length; sl++) {\r\n\t\twindow.mySliders.push(new Slider(sliders[sl], sl));\t\r\n\t}\r\n\r\n\t// Загрузка картинок по пустому запросу\r\n\tgetPictures();\r\n\r\n\t// Кроссбраузерная установка обработчика на кнопку запроса картинок\r\n\tEvent.add(\r\n\t\tdocument.querySelector('.request-area .round-button'), \r\n\t\t'click', \r\n\t\tfunction (e) {\r\n\t\t\tvar elem = document.querySelector('.request-area input');\r\n\t\t\tgetPictures(elem.value);\r\n\t\t}\r\n\t);\r\n}\r\n"],"file":"main.js","sourceRoot":"/source/"}